# 插入排序 Insertion Sort

> 封面图来自 Pexels 上的 XX 拍摄的图片

## （一）思路分析

插入排序思路下，将待排序数组分为了两个区间：

1. 已排序区间
2. 未排序区间

初始，已排序区间只有 1 个元素，就是数组的第 1 个元素，其余元素都处在未排序区间中。以数组 `[8, 2, 4, 9, 3, 6]` 为例，升序排序，初始情况如图：

接着怎么进行排序呢？

**取未排序区间中的元素，在已排序区间中找到合适的插入位置将其插入，并保持排序区间数据一直有序。重复该过程直到未排序区间中没有元素**。这就是插入排序的核心思路

我把对数组 `[8, 2, 4, 9, 3, 6]` 的插入排序过程画了出来，如图：

![插入排序过程](https://user-images.githubusercontent.com/79783808/132354414-d758b4d4-b807-485c-839d-4cc4973c9b1d.jpg)

过程中包含两种操作：

* 元素比较：待插数据与已排序区间的元素依次比较大小
* 元素移动：过程中，如果待插元素 < 有序区间中所比较的元素，那么后者后移 1 位，待插元素继续与前面的元素比较，直到遇到不小于待插元素的元素（或者已遍历到有序区间的尽头），最终再插入待插元素

因此，插入排序的过程，就是不断扩张已排序区间，不断缩小未排序区间的过程

整个过程有点像玩牌时给手中的扑克牌排序：

![给扑克牌排序](https://user-images.githubusercontent.com/79783808/132353543-4909717d-50d3-4cbe-997c-9af0f878d864.jpeg)

一开始发牌后，手中最左面的第 1 张牌是有序区间，然后从第 2 张牌开始，拿起来，依次和左面的牌比较，并插在合适的位置。重复该过程直到手中最右面的牌也插入好为止，整个牌就从左至右、从小到大排序完成了

## （二）编码实现

```js
/**
 * @description 插入排序，升序
 * @param {array} arr 数字数组
 */
function insertionSort(arr) {
  if (!Array.isArray(arr) || arr.length < 2) return arr;

  const len = arr.length;
  let i = 1; // 待插元素索引

  // 外层循环：依次取待插入元素，直到所有元素都插入完成
  while (i < len) {
    const toInsert = arr[i]; // 待插元素
    let j = i - 1; // 比较元素的索引，从待插元素前一个开始比较

    // 内层循环：待插入元素与有序区间元素依次比较，有序区间元素移位
    while(j >= 0) {
      if (toInsert < arr[j]) {
        // 待插元素更小，所比较的有序区间元素后移 1 位
        arr[j+1] = arr[j];
        j--;
      } else {
        break;
      }
    }
    arr[j+1] = toInsert; // 插入元素
    i++;
  }
  return arr;
}

console.log(insertionSort([3, 5, 4, 1, 2, 6])); // [ 1, 2, 3, 4, 5, 6 ]
```
